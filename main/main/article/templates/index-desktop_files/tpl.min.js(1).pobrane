!function(){"use strict";(window.$sf?window.onetAds:parent.onetAds).registerTemplate(function(){return{tplCode:"lps/Analytics-Prebid",version:"2.1.0",renderAd:function(i,s,t){if(s.prebidAnalyticsState=s.prebidAnalyticsState||{},s.prebidAnalyticsState.cacheBidders=s.prebidAnalyticsState.cacheBidders||{},1!==t.parent.RasPrebidAnalytics(function(){},"checkRegistered")){var e,d=this,n=s.prebidAnalyticsState.cacheBidders,r=s._.range(i.fields.sample_cnt),o=function(e){var i=n[e.auctionId],t=v({},e,e.bidderCode);p(i,[t])},a=function(e){var i,t=n[e.auctionId].bidders;e.bidderCode in t&&((i=t[e.bidderCode]).responseTime=Date.now(),i.duration=i.responseTime-i.startTime)},c=function(e){var i=n[e.auctionId].bidders;if(i[e.bidder]&&i[e.bidder].bids)for(var t=0;t<i[e.bidder].bids.length;t++){var d=i[e.bidder].bids[t];d.bidId===e.requestId&&(d.timeToRespond=e.timeToRespond,d.cpm=e.cpm)}},u=function(t){b(t.bidsReceived,"requestId",t.auctionId),b(t.noBids,"bidId",t.auctionId),e=setTimeout(function(){var e=n[t.auctionId],i=l(e);p(e,i)},1e3)},b=function(e,t,d){e.forEach(function(i){var e=n[d].bidders;e[i.bidder].timeouted=e[i.bidder].timeouted||[],e[i.bidder].timeouted=e[i.bidder].timeouted.filter(function(e){return i.bidId!==e[t]})})},p=function(d,n){s.getUserInfo(function(e){var i={context:f(e),resources:n},t="https://"+s.getCsrLocation()+".onet.pl/"+s.getNetworkId()+"/resource/collector";-1!==s._.indexOf(r,d.sendChance)&&s.sendAdHealth(t,i,"PrebidAnalytics")})},f=function(e){return{ip:s.pgid,iv:s.iv,cs:t.parent.screen.width+"x"+t.parent.screen.height+"x"+t.parent.screen.colorDepth,dv:s.dv,dr:s.dr,site:s.site,area:s.area,iver:s.version,pver:s.prebidVersion,vs:s.getVisibilityState(),v:d.version,seg_ab:e.seg_ab,scnt:i.fields.sample_cnt}},l=function(e){var n=[];return Object.keys(e.bidders).forEach(function(t){var d=e.bidders[t];d.bids.forEach(function(e){var i=v(d,e,t);n.push(i)})}),e.bidders={},n},v=function(e,i,t){var d,n,r,o=(d=i).adUnitCode in s.div2slot?s.div2slot[d.adUnitCode]:null;return{slot:o?o.slot:null,pos:m(o),sm:t,sk:"prebid_adapter",rs:I(e,o),duration:h(e,i,o),br:i.cpm||null,sts:(r=(n=i).cpm,"rendered"===n.status?"WIN":r?"BID AVAILABLE":"NO BID")}},m=function(e){return e&&e.opts&&parseInt(e.opts.pos,10)||null},I=function(e,i){return e.timeouted=e.timeouted||[],e.timeouted.find(function(e){return e.adUnitCode===i.div})?-1:200},h=function(e,i,t){return t&&i.adUnitCode!==t.div?null:i.timeToRespond?i.timeToRespond:e.duration};return t.parent.RasPrebidAnalytics=function(e,i,t){return"bidRequested"===i&&(n[t.auctionId].bidders[t.bidderCode]={bids:t.bids,timeouted:t.bids,startTime:t.start}),"auctionInit"===i&&(n[t.auctionId]=n[t.auctionId]||{},n[t.auctionId].sendChance=s._.random(0,99),n[t.auctionId].bidders=n[t.auctionId].bidders||{},0),"bidderDone"===i&&a(t),"auctionEnd"===i&&u(t),"bidResponse"===i&&c(t),"bidWon"===i&&o(t),1},s.on("beforeChangeView",function(){clearTimeout(e)}),!0}}}})}();
//# sourceMappingURL=tpl.min.js.map