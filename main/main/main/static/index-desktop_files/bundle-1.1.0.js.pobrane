!function(e,t){for(var i in t)e[i]=t[i]}(window,function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var s=.5,r={OFF:"off",PLAYING:"playing",PAUSE:"pause",USER_PAUSE:"user_pause"},a=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opts=t,this.root=i,this.playerInstance=n,this.playerState=r.OFF,this.minReqVisibility=s,this.timerId=null}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"init",value:function(){this.currentVisibility=window.embedApi.getCurrentVisibility()||0,this.playerInstance.on(flowplayer.events.PLAYING,this._handlePlayerPlay),this.playerInstance.on(flowplayer.events.PAUSE,this._handlePlayerPause),this._onPostMessage(this._handlePostMessage.bind(this)),this._handleVisibilityChange()}},{key:"_handlePlayerPlay",value:function(){this.playerState=r.PLAYING}},{key:"_handlePlayerPause",value:function(){this.playerState!==r.PAUSE&&(this.playerState=r.USER_PAUSE)}},{key:"_onPostMessage",value:function(e){window.addEventListener?addEventListener("message",e,!1):attachEvent("onmessage",e)}},{key:"_handlePostMessage",value:function(e){var t={};try{t=JSON.parse(e.data)}catch(e){return}"number"==typeof t.vis&&t.vis>=0&&(this.currentVisibility=t.vis,this._handleVisibilityChange())}},{key:"_handleVisibilityChange",value:function(){var e=this;!this.timerId&&this.isVisible()&&(this.timerId=window.setTimeout(function(){var t=embedApi.getEmbedContext(),i=embedApi.getPlayerConfig();"MAIN_ELEMENT"!==t&&2===i.autoplay&&e._startPlayer()},500)),!this.isVisible()&&this.timerId&&(clearTimeout(this.timerId),this.timerId=null)}},{key:"_startPlayer",value:function(){[r.USER_PAUSE,r.PLAYING].includes(this.playerState)||(this.playerInstance.togglePlay(!0),this.playerInstance.emit("autostart_by_visibility"))}},{key:"setMinReqVisibility",value:function(e){"number"==typeof e&&e<=1&&e>=0&&(this.minReqVisibility=e)}},{key:"getMinReqVisibility",value:function(){return this.minReqVisibility}},{key:"getCurrentVisibility",value:function(){return this.currentVisibility}},{key:"isVisible",value:function(){return this.getCurrentVisibility()>=this.getMinReqVisibility()}}]),e}();window.flowplayer(function(e,t,i){new a(e,t,i).init()})}]));