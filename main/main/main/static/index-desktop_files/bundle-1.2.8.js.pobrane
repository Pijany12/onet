!function(t,e){for(var a in e)t[a]=e[a]}(window,function(t){var e={};function a(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},a.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=0)}([function(t,e,a){"use strict";var n;function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.r(e);var r=(i(n={},flowplayer.events.PLAYING,"PLAYING"),i(n,flowplayer.events.ENDED,"PLAYING_END"),i(n,flowplayer.events.PAUSE,"PAUSED"),i(n,flowplayer.events.SEEKING,"SEEK_STARTED"),i(n,flowplayer.events.SEEKED,"SEEK_STOPPED"),i(n,flowplayer.events.MOUNT,"PLAYER_READY"),i(n,flowplayer.events.WAITING,"BUFFERING_START"),i(n,flowplayer.events.ERROR,"ERROR"),i(n,"playing_after_postroll","PLAYING"),i(n,"playing_start","PLAYING_START"),i(n,"playing_autostart","PLAYING_AUTOSTART"),i(n,"playing_autostart_cont","PLAYING_AUTOSTART_CONT"),i(n,"ad-started","AD_PLAY"),i(n,"ad-completed","AD_STOP"),i(n,"ad-pause-content","AD_BREAK"),i(n,"ad-skipped","AD_SKIP"),n),o={rs:"EA-5437314"},s=function(){for(var t="",e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16).toUpperCase();return t};function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=[],n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(a.push(o.value),!e||a.length!==e);n=!0);}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return a}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e,this.container=a,this.streamId=s(),this.eventsCounter=0,this.playerStarted=!1,this.playerBuffering=!1,this.keepTimer=null,this.imaAdManager=null,this.imaAd=null,this.videoDetails=null,this.wasPlayerMuted=!1,this.mutedAtStart=null,this.preRollCompleted=!1,this.playerStartingModeReported=!1,this.autostartModePlaylist=!1,this.autostartModeVisibility=!1,this.noAds=!1}return function(t,e,a){e&&u(t.prototype,e),a&&u(t,a)}(t,[{key:"init",value:function(){this.container.setAttribute("data-stream-id",this.streamId),this._attachEvents()}},{key:"_attachEvents",value:function(){var t=this;"complete"===document.readyState?this._vidEvent("DOCUMENT_READY"):document.addEventListener("DOMContentLoaded",function(e){t._vidEvent("DOCUMENT_READY")}),this.player.on(Object.keys(r),function(e){t._handleEvent(e)}),this.player.on(flowplayer.events.VOLUME_CHANGE,function(e){t._handleVolumeChangeEvent(e)}),this.player.on(["autostart_by_visibility","autostart_by_playlist"],function(e){t._handleAutoStartEvent(e)}),this.player.on(["ad-break-completed","ad-request-error"],function(e){t._handleBreakCompletedEvent(e)}),this.player.on(["ADP_ADS_EMPTY"],function(e){t._handleEmptyAdsEvent(e)}),flowplayer.AdEvents&&flowplayer.AdEvents.IMA_ADAPTER_INIT&&this.player.on(flowplayer.AdEvents.IMA_ADAPTER_INIT,function(e){t.imaAdManager=e.data,t.imaAdManager.addEventListener(google.ima.AdEvent.Type.STARTED,function(e){t.imaAd=e.getAd()}),t.imaAdManager.addEventListener(google.ima.AdEvent.Type.CLICK,function(e){t._vidEvent("AD_CLICK")})})}},{key:"_handleEvent",value:function(t){var e=t.type;switch(e){case flowplayer.events.MOUNT:this.mutedAtStart=this.player.muted;break;case flowplayer.events.WAITING:this.playerBuffering=!0;break;case flowplayer.events.PLAYING:case"playing_after_postroll":if(this.playerBuffering&&(this.playerBuffering=!1,this._vidEvent("BUFFERING_STOP")),this.playerStarted||(this._vidEvent("START"),this.setupKeepPlayingTimer(),this.playerStarted=!0),!this.isPreRollCompleted())return;this.playerStartingModeReported||(e=this.getPlayerStartingType(),this.playerStartingModeReported=!0);break;case flowplayer.events.PAUSE:if(!this.isPreRollCompleted())return;break;case flowplayer.events.ENDED:if(t.data)return;this.resetState(),this.clearKeepPlayingTime()}this._vidEvent(r[e])}},{key:"resetState",value:function(){this.playerStarted=!1,this.preRollCompleted=!1,this.noAds=!1,this.playerStartingModeReported=!1,this.autostartModePlaylist=!1,this.autostartModeVisibility=!1}},{key:"getPlayerStartingType",value:function(){return this.autostartModePlaylist?"playing_autostart_cont":this.autostartModeVisibility?"playing_autostart":this.player.autoplay?"playing_autostart":"playing_start"}},{key:"isPreRollCompleted",value:function(){return!flowplayer.ads||!this.player.opts.ima||(!!this.noAds||this.preRollCompleted)}},{key:"_handleVolumeChangeEvent",value:function(t){this.mutedAtStart&&!this.player.muted&&(this.wasPlayerMuted=!0)}},{key:"_handleBreakCompletedEvent",value:function(t){this.preRollCompleted=!0,this.player.emit("playing_after_postroll")}},{key:"_handleEmptyAdsEvent",value:function(t){this.noAds=!0}},{key:"_handleAutoStartEvent",value:function(t){switch(t.type){case"autostart_by_playlist":this.autostartModePlaylist=!0;break;case"autostart_by_visibility":this.autostartModeVisibility=!0}}},{key:"clearKeepPlayingTime",value:function(){this.keepTimer&&(clearInterval(this.keepTimer),this.keepTimer=null)}},{key:"setupKeepPlayingTimer",value:function(){var t=this;this.keepTimer||(this.keepTimer=setInterval(function(){t.player.paused||t._vidEvent("KEEP-PLAYING")},15e3))}},{key:"_vidEvent",value:function(t){var e=this;embedApi.getVideoDetails().then(function(a){e.videoDetails=a;var n,i=e._getStreamData(e.player.original_src,e.videoDetails.src);n=t.startsWith("AD_")?e._getVidEventAdDataParam(t,e.videoDetails.id,e.videoDetails.meta.publicationId,i["data-format"],i["data-bitrate"]):e._getVidEventDataParam(t,e.videoDetails.id,e.videoDetails.meta.publicationId,i["data-format"],i["data-bitrate"]);var r=e._buildParams();if(window.$onet)try{window.$onet.vidEvent(n,t,e.player.currentTime,e.videoDetails.meta.duration,r),e.eventsCounter++}catch(t){console.warn("Error while trying send vidEvent: %s",t)}else console.warn("No libs for vidEvent!")}).catch(function(t){console.warn("Error reporting vidEvent!: %s",t)})}},{key:"_getVidEventDataParam",value:function(t,e,a,n,i){return"".concat(this.PREFIX,":").concat(e,",").concat(a,",video/").concat(n,",").concat(i)}},{key:"_getVidEventAdDataParam",value:function(t,e,a,n,i){var r=this.imaAd?this.imaAd.getAdSystem():"",o=this.imaAd?this.imaAd.getAdId():0,s=this.imaAd?this.imaAd.getCreativeId():0,l=this.imaAd?this.imaAd.getAdPodInfo().getPodIndex():0,u=this.imaAd?this.imaAd.getAdPodInfo().getTotalAds():0;return"".concat(this.PREFIX,":").concat(e,",").concat(a,",video/").concat(n,",").concat(i,",")+"".concat(r,",").concat(o,",").concat(o,",").concat(s,",").concat(l,",").concat(u)}},{key:"_buildParams",value:function(){var t={XI:flowplayer.version,VEN:this.eventsCounter,VIS:this.streamId,DO:this.DO,VS:this.VS,VSLOT:this.VSLOT,VNA:this.VNA,VEM:this.VEM,DA:this.DA,TID:this.TID,PMU:this.PMU,PIP:this.PIP,PU:this.PU,VSM:this.VSM};return Object.entries(t).reduce(function(t,e){var a=l(e,2),n=a[0],i=a[1];return null!=i?"".concat(t).concat(t?"&":"").concat(n,"=").concat(i):t},"")}},{key:"_getStreamData",value:function(t,e){var a={},n=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(l.src===t){a=l;break}}}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return a}},{key:"PREFIX",get:function(){var t=embedApi.getPlayerConfig();return t.kropkaPrefix?t.kropkaPrefix:"video"}},{key:"DO",get:function(){return this.videoDetails.meta.owner}},{key:"PU",get:function(){var t="function"==typeof onet&&onet("get","keyvalues")||{};return t.ci?t.ci:null}},{key:"PMU",get:function(){return this.videoDetails.uuid}},{key:"VS",get:function(){var t=this._getStreamData(this.player.original_src,this.videoDetails.src);return"fp-".concat(t["data-format"])}},{key:"VSLOT",get:function(){return-1!==embedApi.getPlayerConfig().embedType.indexOf("inTextVideo")?"splayer":"player"}},{key:"VEM",get:function(){return embedApi.getPlayerConfig().embedType}},{key:"VNA",get:function(){var t=[];return embedApi.getPlayerConfig().enableAds||t.push("ea"),this.videoDetails.meta.nobanner&&t.push("nb"),t.join(",")}},{key:"DA",get:function(){var t="function"==typeof onet&&onet("get","site")||"default",e="function"==typeof onet&&onet("get","area")||"default";return"".concat(t,"/").concat(e)}},{key:"TID",get:function(){var t="function"==typeof onet&&onet("get","tid")||"";if(!t){var e=window.location.hostname.split(".").reverse()[0];e in o||!window.onetAds||!window.onetAds.target||(e=window.onetAds.target.split("/")[0].split("_").reverse()[0]),t=o[e]||""}return t}},{key:"PIP",get:function(){var t=embedApi.getPageContext();return t&&t.keyValues&&t.keyValues.IP||""}},{key:"VSM",get:function(){return this.mutedAtStart&&!this.wasPlayerMuted?"ms":this.wasPlayerMuted?"wm":"ns"}}]),t}();flowplayer(function(t,e,a){new d(a,e).init()})}]));